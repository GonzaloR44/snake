' Gambas class file

Private serpiente As Serpiente
Private iPasos As Integer
Private iCrecer As Integer
Private decorar As Float
'
Public Sub Timer1_Timer()
  Dim muerta As Boolean
  muerta = False
  DrawingArea1.Refresh()

   If Button1.Text = "Pausar" Then
      DibujarJuego()
      iPasos = iPasos + 1
      iCrecer = iCrecer + 1
      If iPasos = 20 Then 
         serpiente.moverse()
         iPasos = 1
         muerta = serpiente.estasMuerta(DrawingArea1.Width, DrawingArea1.Height)
      Endif
      If iCrecer = 20 And False Then 
         serpiente.crecer()
         iCrecer = 1
         muerta = serpiente.estasMuerta(DrawingArea1.Width, DrawingArea1.Height)
      Endif
      
      If muerta Then 
         'Message.Info("¡Has muerto!")
         Button1.Text = "Reiniciar"
      Endif
      
   Else 
     DibujarPausa()
  
  Endif 

End

Private miCuadrado As Cuadrado

Public Sub DrawingArea1_KeyPress()
   If serpiente <> Null Then
      Dim k As String = UCase$(Key.Text)
      If k = "W" Or k = "A" Or k = "S" Or k = "D" Then
         serpiente.cambiarDir(k)
      Endif 
      
   Endif
End

Public Sub Form_KeyPress()
   
   DrawingArea1_KeyPress()
   
End



Public Sub DibujarPausa()
  
    ''Mouse.Move(2 + Mouse.ScreenX + Sin((Label1.Width) / 100) * 5, Mouse.ScreenY + Cos((Label1.Width) / 100) * 5)
    
    ' Mouse.Move(Mouse.ScreenX + 1, Mouse.ScreenY + Sin((Label1.Width) / 100) * 5)
    
    Dim tmp1 As Float
    tmp1 = Sin((decorar) / 100) * 100 + 155
    'DrawingArea1.Background = Color.RGB(tmp1, tmp1, tmp1)
    
    If Button1.Text = "Reiniciar" Then 
       DrawingArea1.Background = Color.RGB(Cos((decorar) / 100) * 100 + 140, 0, 0)
    Else 
       DrawingArea1.Background = Color.RGB(0, 0, Cos((decorar) / 100) * 100 + 140)
    Endif 
    
    DrawingArea1.Refresh
    FMain.Background = Color.RGB(tmp1, tmp1, tmp1)
    Label1.Text = "Puntuación: "
    decorar += 8
  
  
End


Public Sub DibujarJuego()
  
    FMain.Background = Color.RGB(255, 255, 255)
    DrawingArea1.Refresh
  
End


Public Sub DrawingArea1_Draw()

  
   If (serpiente <> Null) Then
    serpiente.pintarse(DrawingArea1)
    
  Endif

End

Public Sub Button1_Click()
  
    miCuadrado = New Cuadrado(Color.Yellow, 30, 200, 200)
If Button1.Text = "Empezar" Then
    DrawingArea1.Background = Color.Lighter(Color.RGB(Rand(0, 255), Rand(0, 255), Rand(0, 255)))
  Button1.Text = "Pausar" 
  serpiente = New Serpiente(80, 80, &H00FF00) '///////////////////////////////////// SERPIENTE SPAWN
  serpiente.crecer()
  
Else 
  Button1.Text = "Empezar"
  serpiente = Null
  DrawingArea1.Clear()
 Endif 
 

End

Public Sub Form_Open()

  

End
